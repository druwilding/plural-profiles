- content_for(:title) { "Manage groups in #{@group.name} — Plural Profiles" }

%h1
  Manage groups in
  = @group.name

%h2 Current groups

- if @child_links.any?
  .card-list
    - @child_links.each do |link|
      - child = link.child_group
      .card.card--row
        .card__header
          - if child.avatar.attached?
            = image_tag child.avatar.variant(resize_to_fill: [40, 40]), class: "avatar avatar--small", width: 40, height: 40, alt: child.avatar_alt_text.presence || ""
          - else
            .avatar.avatar--small.avatar--placeholder
              = render "shared/plural_pride_logo"
          %div
            %span= child.name
            = link_to toggle_relationship_our_group_path(@group, group_id: child.id), data: { turbo_method: :patch }, class: "toggle-label", role: "switch", aria: { checked: link.nested?, label: "Include sub-groups for #{child.name}" } do
              %input{type: "checkbox", id: "toggle_#{link.id}", checked: link.nested?, disabled: true, tabindex: "-1", "aria-hidden": "true"}
              %span.toggle-track
              %span.toggle-text Include sub-groups
        = link_to "Remove", remove_group_our_group_path(@group, group_id: child.id), data: { turbo_method: :delete }, class: "btn btn--danger btn--small"
- else
  .card
    %p No groups have been added to this group.

%h2 Add a group

- if @available_groups.any?
  .card-list
    - @available_groups.each do |group|
      .card.card--row
        .card__header
          - if group.avatar.attached?
            = image_tag group.avatar.variant(resize_to_fill: [40, 40]), class: "avatar avatar--small", width: 40, height: 40, alt: group.avatar_alt_text.presence || ""
          - else
            .avatar.avatar--small.avatar--placeholder
              = render "shared/plural_pride_logo"
          %span= group.name
        = link_to "Add", add_group_our_group_path(@group, group_id: group.id), data: { turbo_method: :post }, class: "btn btn--small"
- else
  .card
    %p
      - if Current.user.groups.count > 1
        All your other groups are already in this group.
      - else
        You need to
        = link_to "create more groups", new_our_group_path
        first.

%p= link_to "← Back to group", our_group_path(@group)
