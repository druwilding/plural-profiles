- content_for(:title) { "Account — Plural Profiles" }

%h1 Account

.card
  %h2 Invite codes
  %p Generate codes to invite others to Plural Profiles. You can have up to #{InviteCode::MAX_UNUSED_PER_USER} unused codes at a time.

  - unused_codes = Current.user.invite_codes.unused.order(created_at: :asc)
  - if unused_codes.any?
    %ul.invite-code-list
      - unused_codes.each do |invite|
        %li.invite-code-item
          %code.invite-code= invite.code
  - else
    %p.muted No unused invite codes yet.

  = button_to "Generate invite code", our_invite_codes_path, method: :post, class: "btn"

.card
  %h2 Change email
  %p
    Current email:
    %strong= Current.user.email_address

  - if Current.user.pending_email_change?
    %p.flash.flash--warning
      ⏳ Verification pending for
      %strong= Current.user.unverified_email_address
      = link_to "Cancel", cancel_email_change_our_account_path, data: { turbo_method: :delete }

  = form_with url: update_email_our_account_path, method: :patch do |form|
    .form-group
      = form.label :unverified_email_address, "New email address"
      = form.email_field :unverified_email_address, required: true, autocomplete: "email", value: ""

    .form-group
      = form.submit "Send verification email"

.card
  %h2 Change password
  = form_with url: update_password_our_account_path, method: :patch do |form|
    .form-group
      = form.label :current_password, "Current password"
      = form.password_field :current_password, required: true, autocomplete: "current-password"

    .form-group
      = form.label :password, "New password"
      = form.password_field :password, required: true, minlength: 8, autocomplete: "new-password"

    .form-group
      = form.label :password_confirmation, "Confirm new password"
      = form.password_field :password_confirmation, required: true, minlength: 8, autocomplete: "new-password"

    .form-group
      = form.submit "Update password"
