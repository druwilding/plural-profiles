- content_for(:title) { @group.name + " â€” Plural Profiles" }
- content_for(:head) do
  %meta{property: "og:title", content: @group.name}
  %meta{property: "og:site_name", content: "Plural Profiles"}
  %meta{property: "og:type", content: "website"}
  %meta{property: "og:url", content: group_url(@group.uuid)}
  - if @group.description.present?
    %meta{property: "og:description", content: truncate(strip_tags(@group.description), length: 200)}
  - if @group.avatar.attached?
    %meta{property: "og:image", content: rails_representation_url(@group.avatar.variant(resize_to_fill: [512, 512]))}
    %meta{property: "og:image:width", content: "512"}
    %meta{property: "og:image:height", content: "512"}

.card.profile-public
  .profile-header
    - if @group.avatar.attached?
      = link_to rails_blob_path(@group.avatar, disposition: "inline"), target: "_blank", rel: "noopener", title: "Click to see full size" do
        = image_tag @group.avatar.variant(resize_to_fill: [96, 96]), class: "avatar avatar--large", width: 96, height: 96, alt: @group.avatar_alt_text.presence || ""

  %div
    %h1= @group.name

  - if @group.description.present?
    .group-description
      = simple_format(@group.description)

- @descendant_sections.each do |section|
  - section_profiles = section.profiles.sort_by(&:name)
  - if section_profiles.any?
    %h2
      - if section.avatar.attached?
        = link_to group_path(section.uuid) do
          = image_tag section.avatar.variant(resize_to_fill: [32, 32]), class: "avatar avatar--inline", width: 32, height: 32, alt: section.avatar_alt_text.presence || ""
      = link_to section.name, group_path(section.uuid)
    .profile-grid
      - section_profiles.each do |profile|
        = render "groups/profile_card", group: section, profile: profile

- if @direct_profiles.any?
  - if @descendant_sections.any? { |s| s.profiles.any? }
    %h2 Other profiles
  .profile-grid
    - @direct_profiles.each do |profile|
      = render "groups/profile_card", group: @group, profile: profile

- if @descendant_sections.none? { |s| s.profiles.any? } && @direct_profiles.empty?
  .card
    %p No profiles in this group yet.
